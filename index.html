<!doctype html>


<html lang="en">

<head>

  <meta charset="utf-8">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

  <title>Keystroke Dynamics</title>


  <!-- Add to homescreen for Chrome on Android -->

  <meta name="mobile-web-app-capable" content="yes">

  <link rel="icon" sizes="192x192" href="images/android-desktop.png">


  <!-- Add to homescreen for Safari on iOS -->

  <meta name="apple-mobile-web-app-capable" content="yes">

  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta name="apple-mobile-web-app-title" content="Material Design Lite">

  <link rel="apple-touch-icon-precomposed" href="images/ios-desktop.png">


  <!-- Tile icon for Win8 (144x144 + tile color) -->

  <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">

  <meta name="msapplication-TileColor" content="#3372DF">


  <link rel="shortcut icon" href="images/favicon.png">


  <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->

  <!--
    <link rel="canonical" href="http://www.example.com/">
    -->


  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">

  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.teal-red.min.css">

  <link rel="stylesheet" href="styles.css">

  <style>
    #view-source {
      position: fixed;
      display: block;
      right: 0;
      bottom: 0;
      margin-right: 40px;
      margin-bottom: 40px;
      z-index: 900;
    }

    .demo-ribbon {
      width: 100%;
      height: 40vh;
      background-color: #3F51B5;
      -webkit-flex-shrink: 0;
      -ms-flex-negative: 0;
      flex-shrink: 0;
    }

    .demo-main {
      margin-top: -35vh;
      -webkit-flex-shrink: 0;
      -ms-flex-negative: 0;
      flex-shrink: 0;
    }

    .demo-header .mdl-layout__header-row {
      padding-left: 40px;
    }

    .demo-container {
      max-width: 1600px;
      width: calc(100% - 16px);
      margin: 0 auto;
    }

    .demo-content {
      border-radius: 2px;
      padding: 80px 56px;
      margin-bottom: 80px;
    }

    .demo-layout.is-small-screen .demo-content {
      padding: 40px 28px;
    }

    .demo-content h3 {
      margin-top: 48px;
    }

    .demo-footer {
      padding-left: 40px;
    }

    .demo-footer .mdl-mini-footer--link-list a {
      font-size: 13px;
    }

    .ml-5 {
      margin-left: 5px;
    }

    .mdl-tabs__panel {
      padding-top: 20px;
    }
  </style>

</head>

<body>

  <div class="demo-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100">

    <header
      class="demo-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800">

      <div class="mdl-layout__header-row">

        <span class="mdl-layout-title">Keystroke Dynamics</span>

        <div class="mdl-layout-spacer">
        </div>
      </div>

    </header>

    <div class="demo-ribbon"></div>

    <main class="demo-main mdl-layout__content">

      <div class="demo-container mdl-grid mdl-typography--text-center">

        <div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>

        <div
          class="demo-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col">



          <div>
            <h5 style="text-align: left;">Instructions</h5>
            <ul style="text-align: left;">
              <li>Type the EXACT sentence given below.</li>
              <li>Please do not use delete or backspace. If needed, hit RESET button incase you typed anything wrong.</li>
              <li>Use only ONE emailid per person. Please do not use a different email everytime you give the response otherwise we will not have the data needed for the project.</li>
            </ul>
            <ul class="demo-list-item mdl-list">
              <li class="mdl-list__item">
                <span class="mdl-list__item-primary-content">
                  <h4>the quick brown fox jumps over the lazy dog</h4>
                </span>
              </li>
            </ul>
          </div>



          <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
            <div class="mdl-tabs__tab-bar">
                <a href="#entry-panel" class="mdl-tabs__tab is-active">Data Entry</a>
                <a href="#analysis-panel" class="mdl-tabs__tab">Analysis</a>
            </div>

            <div class="mdl-tabs__panel is-active" id="entry-panel">
              <form onsubmit="event.preventDefault(); save('i');">
                <div class="mdl-textfield mdl-js-textfield">
                  <input class="mdl-textfield__input" type="email" required id="email">
                  <label class="mdl-textfield__label" for="sample1">Enter your Email</label>
                </div>
                <div>
                  <div class="mdl-textfield mdl-js-textfield mdl-cell--12-col">
                    <!-- <textarea class="mdl-textfield__input" type="text" rows="3" id="sample5"></textarea> -->
                    <input class="mdl-textfield__input" type="text" id="t-input" required>
                    <label class="mdl-textfield__label" for="sample5">Text lines...</label>
                  </div>
                </div>

                <div class="mdl-grid mdl-typography--text-center">

                  <div class="mdl-layout-spacer"></div>
                  <div class="mdl-cell mdl-cell--4-col">
                    <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect" type='submit'>
                      Save
                    </button>
                    <a class="mdl-button mdl-js-button mdl-button--raised ml-5 mdl-js-ripple-effect" onclick="reset()" type='button'>
                      Reset
                    </a>
                  </div>
                  <div class="mdl-layout-spacer"></div>

                </div>
              </form>
            </div>
            <div class="mdl-tabs__panel" id="analysis-panel">
              <form onsubmit="event.preventDefault(); save('a');">
                <div>
                  <div class="mdl-textfield mdl-js-textfield mdl-cell--12-col">
                    <input class="mdl-textfield__input" type="text" id="a-input" required>
                    <label class="mdl-textfield__label" for="sample5">Text lines...</label>
                  </div>
                </div>

                <div class="mdl-grid mdl-typography--text-center">

                  <div class="mdl-layout-spacer"></div>
                  <div class="mdl-cell mdl-cell--4-col">
                    <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect" type='submit'>
                      Analyse
                    </button>
                    <a class="mdl-button mdl-js-button mdl-button--raised ml-5 mdl-js-ripple-effect" onclick="reset()" type='button'>
                      Reset
                    </a>
                  </div>
                  <div class="mdl-layout-spacer"></div>

                </div>
              </form>
            </div>
          </div>



        </div>

      </div>


    </main>

  </div>


  <div aria-live="assertive" aria-atomic="true" aria-relevant="text" class="mdl-snackbar mdl-js-snackbar">
    <div class="mdl-snackbar__text"></div>
    <button type="button" class="mdl-snackbar__action"></button>
</div>

  <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
  <script type="text/javascript">
// const url = 'https://baconipsum.com/api/?type=all-meat&paras=3&start-with-lorem=1&format=html';

var notification = document.querySelector('.mdl-js-snackbar');

var data = [];
var adata = [];
var iList = ['Shift', 'Meta', 'Tab', ' '];

document.getElementById("t-input").onkeypress = function() {
  // if (event.key != text[this.value.length]) { return false; } else {
    // console.log('p', event.key);
    data.push({ key: event.key, time: Date.now() });
  // };
};

document.getElementById("t-input").onkeyup = function() {
  // console.log('u', event.key, text[event.target.value.length]);
  // if (event.key == text[event.target.value.length]) {
    data.push({ key: event.key, time: Date.now() });
  // };
};

document.getElementById("a-input").onkeypress = function() {
  adata.push({ key: event.key, time: Date.now() });
};

document.getElementById("a-input").onkeyup = function() {
  adata.push({ key: event.key, time: Date.now() });
};


function reset() {
    data = [];
    adata = [];
    document.getElementById('t-input').value = null;
    document.getElementById('a-input').value = null;
}

function searchBuffer(ele) {
  return ele.key === this.v.key;
}

function save(typ) {
    var email = document.getElementById('email').value;
  if (email || typ == 'a') {
    var fmtData = [];
    var buffer = [];

    var temp = typ === 'a' ? adata : data;

    temp.forEach((v, k) => {
      if (iList.indexOf(v.key) < 0) {
        // console.log(v);
        var index = buffer.findIndex((searchBuffer), {v});
        if (index >= 0) {
            fmtData.push({
                key: v.key,
                d: buffer[index].time,
                u: v.time,
            });
            buffer.splice(index,1);
        } else {
            buffer.push(v);
        }
      }
    });

    var xhr = new XMLHttpRequest();
//     var url = "http://localhost:5000/submit";
    var url = "https://keystroke.live/";
    if (typ == 'a') {
      url += "analyse"
    } else {
      url += "submit"
    }
    xhr.open("POST", url, true);
    xhr.setRequestHeader('Access-Control-Allow-Origin', '*');
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.onreadystatechange = function (e) {
        if (xhr.readyState === 4 && xhr.status === 200) {
            var resp = JSON.parse(xhr.responseText);
            if (resp.result == 'Sucessfully recorded your response') {
              msg = 'Thanks for your resonse!';
            } else {
              msg = resp.result;
            }
            notification.MaterialSnackbar.showSnackbar(
              {
                message: msg
              }
            );
            reset();
        }
    };
    if (typ == 'a') {
      var p = JSON.stringify({
        data: fmtData
      });
    } else {
      var p = JSON.stringify({
        email: email,
        data: fmtData
      });
    }
    xhr.send(p);

  } else {
    alert('Please enter email address.');
  }


}

  </script>

</body>

</html>
